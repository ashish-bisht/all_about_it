<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day 8: Backtracking</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg: #f0f2f5;
            --card-bg: #ffffff;
            --text-main: #1a202c;
            --text-muted: #64748b;
            --primary: #7c3aed; /* Violet for Recursion/Magic */
            --primary-light: #f5f3ff;
            --accent: #8b5cf6;
            --must: #dc2626;
            --must-bg: #fef2f2;
            --code-bg: #1e293b;
        }
        
        * { box-sizing: border-box; transition: all 0.2s ease; }
        body { font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text-main); margin: 0; padding: 40px 20px; line-height: 1.6; }
        .container { max-width: 900px; margin: 0 auto; }

        /* Header */
        .header-section { text-align: center; margin-bottom: 40px; }
        .header-section h1 { font-size: 2.5rem; margin-bottom: 10px; color: var(--text-main); letter-spacing: -1px; }

        /* Card Styles */
        .flashcard { background: var(--card-bg); border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); margin-bottom: 30px; overflow: hidden; border: 1px solid #e2e8f0; position: relative; }
        
        .card-header { padding: 20px 25px; border-bottom: 1px solid #f1f5f9; display: flex; justify-content: space-between; align-items: center; background: #fff; }
        .q-title { font-weight: 800; font-size: 1.25rem; color: var(--text-main); display: flex; align-items: center; gap: 12px; }
        
        .badge { font-size: 0.75rem; padding: 4px 10px; border-radius: 6px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
        .badge-must { background: var(--must-bg); color: var(--must); border: 1px solid #fecaca; }
        .tag { font-size: 0.85rem; color: var(--text-muted); background: #f1f5f9; padding: 4px 12px; border-radius: 20px; font-weight: 500; }

        .card-body { padding: 25px; }

        /* Metrics */
        .metrics { display: flex; gap: 20px; margin-bottom: 10px; font-family: 'Menlo', monospace; font-size: 0.85rem; }
        .metric-item { display: flex; align-items: center; gap: 6px; background: #f8fafc; padding: 8px 12px; border-radius: 6px; border: 1px solid #e2e8f0; color: var(--text-muted); cursor: pointer; }
        
        .metric-explainer { 
            display: none; 
            background: #fffbeb; 
            border: 1px solid #fde68a; 
            padding: 15px; 
            border-radius: 8px; 
            font-size: 0.9rem; 
            margin-bottom: 20px; 
            color: #92400e;
        }

        /* Logic Boxes */
        .info-box { padding: 20px; border-radius: 8px; margin-bottom: 20px; font-size: 0.95rem; position: relative; margin-top: 15px; }
        .logic-box { background: var(--primary-light); border-left: 5px solid var(--primary); }
        .trap-box { background: var(--must-bg); border-left: 5px solid var(--must); color: #991b1b; }
        
        .box-label { position: absolute; top: -10px; left: 15px; background: inherit; padding: 0 8px; font-size: 0.75rem; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; border-radius: 4px; }

        /* Visual Area */
        .visual-area { background: #f8fafc; border: 2px dashed #cbd5e1; border-radius: 8px; padding: 20px; text-align: center; color: var(--text-muted); font-size: 0.9rem; margin-bottom: 20px; display: flex; flex-direction: column; align-items: center; gap: 10px; }

        /* Code */
        details { margin-top: 15px; background: var(--code-bg); border-radius: 8px; overflow: hidden; }
        summary { padding: 12px 20px; cursor: pointer; color: #e2e8f0; font-weight: 600; font-size: 0.9rem; display: flex; justify-content: space-between; align-items: center; list-style: none; }
        pre { margin: 0; padding: 20px; overflow-x: auto; color: #e2e8f0; font-family: 'Consolas', monospace; font-size: 0.9rem; line-height: 1.5; position: relative; border-top: 1px solid #334155; }
        .copy-btn { position: absolute; top: 10px; right: 10px; background: rgba(255,255,255,0.1); border: none; color: white; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 0.8rem; }
    </style>
</head>
<body>

<div class="container">

    <div class="header-section">
        <h1>8Ô∏è‚É£ Backtracking Mastery</h1>
        <p style="color: var(--text-muted);">Principal Engineer DSA ‚Ä¢ Part 2</p>
    </div>
    <div class="pattern-card" style="background: linear-gradient(135deg, #4c1d95, #6d28d9); color: white; padding: 30px; border-radius: 16px; margin-bottom: 40px; box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2); font-family: 'Segoe UI', sans-serif;">
        <h3 style="margin-top: 0; display: flex; align-items: center; gap: 10px;">
            <i class="fas fa-brain"></i> Principal's Mental Model: Backtracking
        </h3>
        
        <div class="pattern-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
            
            <div class="pattern-col">
                <h4 style="color: #a78bfa; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 8px; margin-top: 0;">
                    <i class="fas fa-traffic-light"></i> When to Apply
                </h4>
                <ul style="padding-left: 20px; line-height: 1.6; font-size: 0.9rem; margin: 0;">
                    <li style="margin-bottom: 8px;">
                        <strong>"Find ALL Ways/Combinations":</strong> <br>
                        Agar question mein "All" word hai (e.g., Subsets, Permutations), toh ye Backtracking hai.
                    </li>
                    <li style="margin-bottom: 8px;">
                        <strong>Constraint Check (N <= 20):</strong> <br>
                        Agar N chota hai ($N \le 20$), toh $2^N$ ya $N!$ chalega. Agar $N=10^5$ hai, toh Backtracking mat sochna (Time Limit Exceed hoga).
                    </li>
                    <li style="margin-bottom: 8px;">
                        <strong>Decisions (To Be or Not To Be):</strong> <br>
                        Har step pe choice hai: Include karu ya nahi? (Subsets). Yahan queen rakhu ya nahi? (N-Queens).
                    </li>
                </ul>
            </div>

            <div class="pattern-col">
                <h4 style="color: #a78bfa; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 8px; margin-top: 0;">
                    <i class="fas fa-shield-alt"></i> The "10x" Safety Check
                </h4>
                <ul style="padding-left: 20px; line-height: 1.6; font-size: 0.9rem; margin: 0;">
                    <li style="margin-bottom: 8px;">
                        <strong>The Reference Bug (Deadly):</strong> <br>
                        <code>res.append(path)</code> mat likho. Ye live reference store karega jo baad mein change ho jayega. Hamesha <code>res.append(path[:])</code> (Copy) use karo.
                    </li>
                    <li style="margin-bottom: 8px;">
                        <strong>The "Undo" Step:</strong> <br>
                        Pattern yaad rakho: <strong>Do -> Recurse -> Undo</strong>. Agar tumne list mein kuch add kiya hai, toh wapis aate waqt `pop()` karna mat bhoolna.
                    </li>
                    <li style="margin-bottom: 8px;">
                        <strong>Pruning (Speed Hack):</strong> <br>
                        Base case ka wait mat karo. Agar rasta abhi galat lag raha hai (e.g., Queen attack ho rahi hai), toh wahi se return karo. Don't go deeper.
                    </li>
                </ul>
            </div>

        </div>
    </div>
    <div class="flashcard" id="card-5">
        <div class="card-header">
            <div class="q-title">
                <i class="fas fa-chess-queen" style="color: var(--primary);"></i>
                <span>N-Queens</span>
            </div>
            <div style="display:flex; gap:10px; align-items:center;">
                <span class="badge badge-must">MUST DO</span>
                <span class="tag">State Space Tree</span>
            </div>
        </div>
        <div class="card-body">
            
            <div class="metrics">
                <div class="metric-item" onclick="toggleExplainer('queen-time')">
                    <i class="far fa-clock"></i> O(N!) Time <i class="fas fa-info-circle" style="font-size:0.8em; margin-left:5px;"></i>
                </div>
                <div class="metric-item" onclick="toggleExplainer('queen-space')">
                    <i class="fas fa-server"></i> O(N) Space <i class="fas fa-info-circle" style="font-size:0.8em; margin-left:5px;"></i>
                </div>
            </div>

            <div id="queen-time-explainer" class="metric-explainer">
                <strong>Why O(N!)?</strong> <br>
                First row has N choices, second has N-1, third has N-2... It creates a factorial growth tree. Pruning helps, but worst case is still factorial.
            </div>

            <div class="visual-area">
                
                <br>
                <span><strong>Visual: The Danger Zones</strong><br>Check karna ki Queen safe hai ya nahi, $O(N)$ nahi lagna chahiye.<br><strong>Positive Diag (/):</strong> `row + col` constant hota hai.<br><strong>Negative Diag (\):</strong> `row - col` constant hota hai.<br>Agar hum in sums ko Sets mein store karein, toh check **O(1)** ho jata hai.</span>
            </div>

            <div class="info-box logic-box">
                <span class="box-label" style="color: var(--primary)">üí° The Crux</span>
                <strong>The "3-Set" Optimization:</strong>
                <br>Hum `isSafe()` function likh ke loop nahi chalayenge. Hum 3 Sets maintain karenge:
                <br>1. <code>cols</code>: Kaunse column mein queen hai.
                <br>2. <code>pos_diag</code>: (r + c) values.
                <br>3. <code>neg_diag</code>: (r - c) values.
                <br>Agar teeno sets mein current coordinate nahi hai -> Place Queen!
            </div>

            <div class="info-box trap-box">
                <span class="box-label" style="color: #991b1b">‚ö†Ô∏è The Trap</span>
                <strong>String Building Overhead:</strong> 
                <br>Recursion ke har step pe Board ka string version (e.g., `["Q..", "..Q"]`) mat banao. Ye bahut slow hai.
                <br>Recursion mein sirf index store karo (e.g., `queens = [1, 3, 0, 2]`). String tabhi banao jab Base Case (`row == n`) hit ho jaye.
            </div>

            <details>
                <summary>Python Solution (O(1) Check)</summary>
                <div style="position: relative;">
                    <button class="copy-btn" onclick="copyCode('code-queen')">Copy</button>
                    <pre id="code-queen">
def solveNQueens(n):
    # Sets for O(1) Safety Check
    cols = set()
    pos_diag = set() # (r + c)
    neg_diag = set() # (r - c)
    
    res = []
    # To store position: board[row] = col
    board_state = [-1] * n
    
    def backtrack(r):
        # Base Case: All queens placed
        if r == n:
            # Construct the visual board now
            temp = []
            for i in range(n):
                col_idx = board_state[i]
                row_str = "." * col_idx + "Q" + "." * (n - col_idx - 1)
                temp.append(row_str)
            res.append(temp)
            return

        # Try every column for current row 'r'
        for c in range(n):
            # Pruning: Check if under attack
            if c in cols or (r + c) in pos_diag or (r - c) in neg_diag:
                continue
                
            # Place Queen
            cols.add(c)
            pos_diag.add(r + c)
            neg_diag.add(r - c)
            board_state[r] = c
            
            # Recurse
            backtrack(r + 1)
            
            # Backtrack (Undo)
            cols.remove(c)
            pos_diag.remove(r + c)
            neg_diag.remove(r - c)
            board_state[r] = -1
            
    backtrack(0)
    return res</pre>
                </div>
            </details>
        </div>
    </div>

    <div class="flashcard" id="card-6">
        <div class="card-header">
            <div class="q-title">
                <i class="fas fa-random" style="color: var(--primary);"></i>
                <span>Permutations</span>
            </div>
            <div style="display:flex; gap:10px; align-items:center;">
                <span class="badge badge-good">GOOD</span>
                <span class="tag">Swapping</span>
            </div>
        </div>
        <div class="card-body">
            
            <div class="metrics">
                <div class="metric-item" onclick="toggleExplainer('perm-time')">
                    <i class="far fa-clock"></i> O(N * N!) <i class="fas fa-info-circle" style="font-size:0.8em; margin-left:5px;"></i>
                </div>
                <div class="metric-item" onclick="toggleExplainer('perm-space')">
                    <i class="fas fa-server"></i> O(N) Space <i class="fas fa-info-circle" style="font-size:0.8em; margin-left:5px;"></i>
                </div>
            </div>

            <div id="perm-time-explainer" class="metric-explainer">
                <strong>Why O(N * N!)?</strong> <br>
                Total permutations $N!$ hain. Har permutation ko result list mein copy karne ke liye $O(N)$ time lagta hai.
            </div>

            <div class="visual-area">
                
                <br>
                <span><strong>Visual: The Empty Seats</strong><br>Socho 3 kursiyan (chairs) hain aur 3 log (A, B, C).<br>Pehli kursi ke liye 3 options.<br>Dusri ke liye 2 options (jo bacha hai).<br>Teesri ke liye 1 option.<br>Ye tree structure banta hai decisions ka.</span>
            </div>

            <div class="info-box logic-box">
                <span class="box-label" style="color: var(--primary)">üí° The Crux</span>
                <strong>The Swap Strategy (Space Optimization):</strong>
                <br>Extra `visited` array mat banao. Input array ko hi modify karo.
                <br>1. Loop chalao `index` se `len` tak.
                <br>2. Current element ko `index` ke saath <strong>Swap</strong> karo (Ye fix ho gaya).
                <br>3. Recurse karo (`index + 1`).
                <br>4. Wapis aate waqt wahi Swap dubara karo (Backtrack) taaki array original state mein aa jaye.
            </div>

            <div class="info-box trap-box">
                <span class="box-label" style="color: #991b1b">‚ö†Ô∏è The Trap</span>
                <strong>Reference Copying (Most Common Bug):</strong> 
                <br>Python mein agar aap `res.append(nums)` likhoge, toh wo list ka <em>Reference</em> copy karega.
                <br>Jaise hi recursion aage badhega aur swap karega, purane results bhi change ho jayenge!
                <br><strong>Fix:</strong> Humesha <strong>Copy</strong> append karo: `res.append(nums[:])`.
            </div>

            <details>
                <summary>Python Solution (Swap Logic)</summary>
                <div style="position: relative;">
                    <button class="copy-btn" onclick="copyCode('code-perm')">Copy</button>
                    <pre id="code-perm">
def permute(nums):
    res = []
    
    def backtrack(start_index):
        # Base Case: Agar hum end tak aa gaye
        if start_index == len(nums):
            # IMPORTANT: nums[:] se copy banake daalo
            res.append(nums[:]) 
            return
            
        for i in range(start_index, len(nums)):
            
            # 1. Action: Swap current element to fixed position
            nums[start_index], nums[i] = nums[i], nums[start_index]
            
            # 2. Recurse: Move to next chair
            backtrack(start_index + 1)
            
            # 3. Backtrack: Swap back (Undo action)
            nums[start_index], nums[i] = nums[i], nums[start_index]
            
    backtrack(0)
    return res</pre>
                </div>
            </details>
        </div>
    </div>

</div>

<script>
    function toggleExplainer(type) {
        document.querySelectorAll('.metric-explainer').forEach(el => el.style.display = 'none');
        const target = document.getElementById(`${type}-explainer`);
        if (target) target.style.display = 'block';
    }

    function copyCode(id) {
        const code = document.getElementById(id).innerText;
        navigator.clipboard.writeText(code).then(() => {
            alert('Code copied to clipboard!');
        });
    }
</script>

</body>
</html>